# =============================================================================
# TfPilot environment variables
# Copy to .env.local and fill in values. See lib/config/env.ts for types.
# =============================================================================

# --- GitHub OAuth (required) ---
# OAuth App must request repo scope (see app/api/auth/github/start/route.ts). Creating requests
# needs write access (create branch, commit, open PR). If users get 403 "Resource not accessible by
# integration", have them sign out and sign in again; for org repos, approve the app in Org â†’ Third-party access.
GITHUB_CLIENT_ID=your_github_oauth_app_client_id
GITHUB_CLIENT_SECRET=your_github_oauth_app_client_secret
# Callback URL for OAuth; set to your app origin + path (e.g. prod: https://tfpilot.com/api/auth/github/callback)
GITHUB_OAUTH_REDIRECT=http://localhost:3000/api/auth/github/callback

# --- Next.js / Auth (required) ---
# Generate with: openssl rand -base64 32
AUTH_SECRET=generate_a_strong_random_secret

# --- GitHub repo defaults (workflow file names and default target repo) ---
GITHUB_DEFAULT_OWNER=your-github-org-or-username
GITHUB_DEFAULT_BASE_BRANCH=main
GITHUB_PLAN_WORKFLOW_FILE=plan.yml
GITHUB_APPLY_WORKFLOW_FILE=apply.yml
GITHUB_DESTROY_WORKFLOW_FILE=destroy.yml
GITHUB_CLEANUP_WORKFLOW_FILE=cleanup.yml

# --- OpenAI (required; used by infra assistant) ---
OPENAI_API_KEY=your_openai_api_key
OPENAI_MODEL=gpt-4o-mini

# --- AWS / TfPilot storage (required) ---
TFPILOT_DEFAULT_REGION=eu-west-2
TFPILOT_APP_NAME=TfPilot
TFPILOT_REQUESTS_BUCKET=tfpilot-requests
TFPILOT_CHAT_LOGS_BUCKET=tfpilot-chat-logs
TFPILOT_TEMPLATES_BUCKET=tfpilot-templates

# --- Access control (comma-separated lists; empty = allow all for that list) ---
# GitHub logins allowed to sign in (empty = allow any)
TFPILOT_ALLOWED_LOGINS=
# GitHub logins allowed to deploy to prod
TFPILOT_PROD_ALLOWED_USERS=
# GitHub logins allowed to destroy prod resources
TFPILOT_DESTROY_PROD_ALLOWED_USERS=
# GitHub logins with admin role
TFPILOT_ADMINS=
# GitHub logins who can approve/merge requests
TFPILOT_APPROVERS=
# AWS regions allowed for new requests (empty = allow any)
TFPILOT_ALLOWED_REGIONS=eu-west-2,us-east-1
# Emails that can access /api/templates/admin and catalogue admin actions (must re-login after adding user:email scope)
TFPILOT_ADMIN_EMAILS=

# --- Email (required) ---
# Sender address for notifications (must be verified in AWS SES if using SES)
TFPILOT_EMAIL_FROM=noreply@yourdomain.com

# --- Optional (CI / build) ---
# Commit SHA for request metadata (e.g. VERCEL_GIT_COMMIT_SHA, GITHUB_SHA)
# TFPILOT_APP_COMMIT=

# --- Next.js ---
NODE_ENV=development
